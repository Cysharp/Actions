name: actionlint cysharp

on:
  workflow_dispatch:
  schedule:
    - cron: "0 1 * * WED" # every wednesday 10:00 +9(JST)

jobs:
  actionlint:
    strategy:
      fail-fast: false
      matrix:
        repository:
          - Claudia
          - ConsoleAppFramework
          - csbindgen
          - CsprojModifier
          - DFrame
          - DocfxTemplate
          - GrpcWebSocketBridge
          - Kokuban
          - LitJWT
          - LogicLooper
          - MagicOnion
          - MagicOnion.Template.Unity
          - MagicPhysX
          - MasterMemory
          - MemoryPack
          - MessagePipe
          - Multicaster
          - ObservableCollections
          - ProcessX
          - R3
          - RandomFixtureKit
          - RuntimeUnitTestToolkit
          - SimdLinq
          - SlnMerge
          - StructureOfArraysGenerator
          - Ulid
          - UniTask
          - UnitGenerator
          - Utf8StreamReader
          - Utf8StringInterpolation
          - ValueTaskSupplement
          - WebSerializer
          - YetAnotherHttpHandler
          - ZLinq
          - ZLogger
          - ZString
    permissions:
      contents: read
    runs-on: ubuntu-24.04
    timeout-minutes: 3
    steps:
      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2
        with:
          persist-credentials: false
      - uses: aquaproj/aqua-installer@e2d0136abcf70b7a2f6f505720640750557c4b33 # v3.1.1
        with:
          aqua_version: v2.43.1
      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2
        with:
          persist-credentials: false
          repository: "cysharp/${{ matrix.repository }}"
          path: ${{ matrix.repository }}
      # github workflows/action's Static Checker
      - name: Run actionlint
        run: actionlint -color -oneline --config-file ../.github/actionlint.yaml
        working-directory: ${{ matrix.repository }}
      # checkout's persist-credentials: false checker
      - name: Run ghalint
        run: ghalint -c ../.ghalint.yaml run
        working-directory: ${{ matrix.repository }}
